"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_thirdweb_dist_esm_wallets_wallet-connect_receiver_session-proposal_js"],{

/***/ "./node_modules/thirdweb/dist/esm/wallets/wallet-connect/receiver/session-proposal.js":
/*!********************************************************************************************!*\
  !*** ./node_modules/thirdweb/dist/esm/wallets/wallet-connect/receiver/session-proposal.js ***!
  \********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   acceptSessionProposal: function() { return /* binding */ acceptSessionProposal; },\n/* harmony export */   disconnectExistingSessions: function() { return /* binding */ disconnectExistingSessions; },\n/* harmony export */   onSessionProposal: function() { return /* binding */ onSessionProposal; }\n/* harmony export */ });\n/* harmony import */ var _index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index.js */ \"./node_modules/thirdweb/dist/esm/wallets/wallet-connect/receiver/index.js\");\n/* harmony import */ var _session_store_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./session-store.js */ \"./node_modules/thirdweb/dist/esm/wallets/wallet-connect/receiver/session-store.js\");\n\n\n/**\n * @internal\n */\nasync function onSessionProposal(options) {\n    const { wallet, walletConnectClient, event, chains, onConnect } = options;\n    const account = wallet.getAccount();\n    if (!account) {\n        throw new Error(\"No account connected to provided wallet\");\n    }\n    const origin = event.verifyContext?.verified?.origin;\n    if (origin) {\n        await disconnectExistingSessions({ origin, walletConnectClient });\n    }\n    const session = await acceptSessionProposal({\n        account,\n        walletConnectClient,\n        sessionProposal: event,\n        chains,\n    });\n    await (0,_session_store_js__WEBPACK_IMPORTED_MODULE_0__.saveSession)(session);\n    wallet.subscribe(\"disconnect\", () => {\n        (0,_index_js__WEBPACK_IMPORTED_MODULE_1__.disconnectWalletConnectSession)({ session, walletConnectClient });\n    });\n    onConnect?.(session);\n}\n/**\n * @internal\n */\nasync function disconnectExistingSessions({ walletConnectClient, origin, }) {\n    const sessions = await (0,_session_store_js__WEBPACK_IMPORTED_MODULE_0__.getSessions)();\n    for (const session of sessions) {\n        if (session.origin === origin) {\n            await (0,_index_js__WEBPACK_IMPORTED_MODULE_1__.disconnectWalletConnectSession)({ session, walletConnectClient });\n        }\n    }\n}\n/**\n * @internal\n */\nasync function acceptSessionProposal({ account, walletConnectClient, sessionProposal, chains, }) {\n    if (!sessionProposal.params.requiredNamespaces?.eip155 &&\n        !sessionProposal.params.optionalNamespaces?.eip155) {\n        throw new Error(\"No EIP155 namespace found in Wallet Connect session proposal\");\n    }\n    const namespaces = {\n        chains: [\n            ...Array.from(new Set([\n                ...(sessionProposal.params.requiredNamespaces?.eip155?.chains?.map((chain) => `${chain}:${account.address}`) ?? []),\n                ...(sessionProposal.params.optionalNamespaces?.eip155?.chains?.map((chain) => `${chain}:${account.address}`) ?? []),\n                ...(chains?.map((chain) => `eip155:${chain.id}:${account.address}`) ??\n                    []),\n            ])),\n        ],\n        methods: [\n            ...(sessionProposal.params.requiredNamespaces?.eip155?.methods ?? []),\n            ...(sessionProposal.params.optionalNamespaces?.eip155?.methods ?? []),\n        ],\n        events: [\n            ...(sessionProposal.params.requiredNamespaces?.eip155?.events ?? []),\n            ...(sessionProposal.params.optionalNamespaces?.eip155?.events ?? []),\n        ],\n    };\n    const approval = await walletConnectClient.approve({\n        id: sessionProposal.id,\n        namespaces: {\n            eip155: {\n                accounts: namespaces.chains,\n                methods: namespaces.methods,\n                events: namespaces.events,\n            },\n        },\n    });\n    const session = await approval.acknowledged();\n    return {\n        topic: session.topic,\n        origin: sessionProposal.verifyContext?.verified?.origin || \"Unknown origin\",\n    };\n}\n//# sourceMappingURL=session-proposal.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdGhpcmR3ZWIvZGlzdC9lc20vd2FsbGV0cy93YWxsZXQtY29ubmVjdC9yZWNlaXZlci9zZXNzaW9uLXByb3Bvc2FsLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTREO0FBQ0U7QUFDOUQ7QUFDQTtBQUNBO0FBQ087QUFDUCxZQUFZLHdEQUF3RDtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsNkJBQTZCO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxVQUFVLDhEQUFXO0FBQ3JCO0FBQ0EsUUFBUSx5RUFBOEIsR0FBRyw4QkFBOEI7QUFDdkUsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyw0Q0FBNEMsOEJBQThCO0FBQ2pGLDJCQUEyQiw4REFBVztBQUN0QztBQUNBO0FBQ0Esa0JBQWtCLHlFQUE4QixHQUFHLDhCQUE4QjtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyx1Q0FBdUMsd0RBQXdEO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUdBQWlHLE1BQU0sR0FBRyxnQkFBZ0I7QUFDMUgsaUdBQWlHLE1BQU0sR0FBRyxnQkFBZ0I7QUFDMUgscURBQXFELFNBQVMsR0FBRyxnQkFBZ0I7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvdGhpcmR3ZWIvZGlzdC9lc20vd2FsbGV0cy93YWxsZXQtY29ubmVjdC9yZWNlaXZlci9zZXNzaW9uLXByb3Bvc2FsLmpzPzlmODEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGlzY29ubmVjdFdhbGxldENvbm5lY3RTZXNzaW9uIH0gZnJvbSBcIi4vaW5kZXguanNcIjtcbmltcG9ydCB7IGdldFNlc3Npb25zLCBzYXZlU2Vzc2lvbiB9IGZyb20gXCIuL3Nlc3Npb24tc3RvcmUuanNcIjtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvblNlc3Npb25Qcm9wb3NhbChvcHRpb25zKSB7XG4gICAgY29uc3QgeyB3YWxsZXQsIHdhbGxldENvbm5lY3RDbGllbnQsIGV2ZW50LCBjaGFpbnMsIG9uQ29ubmVjdCB9ID0gb3B0aW9ucztcbiAgICBjb25zdCBhY2NvdW50ID0gd2FsbGV0LmdldEFjY291bnQoKTtcbiAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gYWNjb3VudCBjb25uZWN0ZWQgdG8gcHJvdmlkZWQgd2FsbGV0XCIpO1xuICAgIH1cbiAgICBjb25zdCBvcmlnaW4gPSBldmVudC52ZXJpZnlDb250ZXh0Py52ZXJpZmllZD8ub3JpZ2luO1xuICAgIGlmIChvcmlnaW4pIHtcbiAgICAgICAgYXdhaXQgZGlzY29ubmVjdEV4aXN0aW5nU2Vzc2lvbnMoeyBvcmlnaW4sIHdhbGxldENvbm5lY3RDbGllbnQgfSk7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhY2NlcHRTZXNzaW9uUHJvcG9zYWwoe1xuICAgICAgICBhY2NvdW50LFxuICAgICAgICB3YWxsZXRDb25uZWN0Q2xpZW50LFxuICAgICAgICBzZXNzaW9uUHJvcG9zYWw6IGV2ZW50LFxuICAgICAgICBjaGFpbnMsXG4gICAgfSk7XG4gICAgYXdhaXQgc2F2ZVNlc3Npb24oc2Vzc2lvbik7XG4gICAgd2FsbGV0LnN1YnNjcmliZShcImRpc2Nvbm5lY3RcIiwgKCkgPT4ge1xuICAgICAgICBkaXNjb25uZWN0V2FsbGV0Q29ubmVjdFNlc3Npb24oeyBzZXNzaW9uLCB3YWxsZXRDb25uZWN0Q2xpZW50IH0pO1xuICAgIH0pO1xuICAgIG9uQ29ubmVjdD8uKHNlc3Npb24pO1xufVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRpc2Nvbm5lY3RFeGlzdGluZ1Nlc3Npb25zKHsgd2FsbGV0Q29ubmVjdENsaWVudCwgb3JpZ2luLCB9KSB7XG4gICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBnZXRTZXNzaW9ucygpO1xuICAgIGZvciAoY29uc3Qgc2Vzc2lvbiBvZiBzZXNzaW9ucykge1xuICAgICAgICBpZiAoc2Vzc2lvbi5vcmlnaW4gPT09IG9yaWdpbikge1xuICAgICAgICAgICAgYXdhaXQgZGlzY29ubmVjdFdhbGxldENvbm5lY3RTZXNzaW9uKHsgc2Vzc2lvbiwgd2FsbGV0Q29ubmVjdENsaWVudCB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhY2NlcHRTZXNzaW9uUHJvcG9zYWwoeyBhY2NvdW50LCB3YWxsZXRDb25uZWN0Q2xpZW50LCBzZXNzaW9uUHJvcG9zYWwsIGNoYWlucywgfSkge1xuICAgIGlmICghc2Vzc2lvblByb3Bvc2FsLnBhcmFtcy5yZXF1aXJlZE5hbWVzcGFjZXM/LmVpcDE1NSAmJlxuICAgICAgICAhc2Vzc2lvblByb3Bvc2FsLnBhcmFtcy5vcHRpb25hbE5hbWVzcGFjZXM/LmVpcDE1NSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBFSVAxNTUgbmFtZXNwYWNlIGZvdW5kIGluIFdhbGxldCBDb25uZWN0IHNlc3Npb24gcHJvcG9zYWxcIik7XG4gICAgfVxuICAgIGNvbnN0IG5hbWVzcGFjZXMgPSB7XG4gICAgICAgIGNoYWluczogW1xuICAgICAgICAgICAgLi4uQXJyYXkuZnJvbShuZXcgU2V0KFtcbiAgICAgICAgICAgICAgICAuLi4oc2Vzc2lvblByb3Bvc2FsLnBhcmFtcy5yZXF1aXJlZE5hbWVzcGFjZXM/LmVpcDE1NT8uY2hhaW5zPy5tYXAoKGNoYWluKSA9PiBgJHtjaGFpbn06JHthY2NvdW50LmFkZHJlc3N9YCkgPz8gW10pLFxuICAgICAgICAgICAgICAgIC4uLihzZXNzaW9uUHJvcG9zYWwucGFyYW1zLm9wdGlvbmFsTmFtZXNwYWNlcz8uZWlwMTU1Py5jaGFpbnM/Lm1hcCgoY2hhaW4pID0+IGAke2NoYWlufToke2FjY291bnQuYWRkcmVzc31gKSA/PyBbXSksXG4gICAgICAgICAgICAgICAgLi4uKGNoYWlucz8ubWFwKChjaGFpbikgPT4gYGVpcDE1NToke2NoYWluLmlkfToke2FjY291bnQuYWRkcmVzc31gKSA/P1xuICAgICAgICAgICAgICAgICAgICBbXSksXG4gICAgICAgICAgICBdKSksXG4gICAgICAgIF0sXG4gICAgICAgIG1ldGhvZHM6IFtcbiAgICAgICAgICAgIC4uLihzZXNzaW9uUHJvcG9zYWwucGFyYW1zLnJlcXVpcmVkTmFtZXNwYWNlcz8uZWlwMTU1Py5tZXRob2RzID8/IFtdKSxcbiAgICAgICAgICAgIC4uLihzZXNzaW9uUHJvcG9zYWwucGFyYW1zLm9wdGlvbmFsTmFtZXNwYWNlcz8uZWlwMTU1Py5tZXRob2RzID8/IFtdKSxcbiAgICAgICAgXSxcbiAgICAgICAgZXZlbnRzOiBbXG4gICAgICAgICAgICAuLi4oc2Vzc2lvblByb3Bvc2FsLnBhcmFtcy5yZXF1aXJlZE5hbWVzcGFjZXM/LmVpcDE1NT8uZXZlbnRzID8/IFtdKSxcbiAgICAgICAgICAgIC4uLihzZXNzaW9uUHJvcG9zYWwucGFyYW1zLm9wdGlvbmFsTmFtZXNwYWNlcz8uZWlwMTU1Py5ldmVudHMgPz8gW10pLFxuICAgICAgICBdLFxuICAgIH07XG4gICAgY29uc3QgYXBwcm92YWwgPSBhd2FpdCB3YWxsZXRDb25uZWN0Q2xpZW50LmFwcHJvdmUoe1xuICAgICAgICBpZDogc2Vzc2lvblByb3Bvc2FsLmlkLFxuICAgICAgICBuYW1lc3BhY2VzOiB7XG4gICAgICAgICAgICBlaXAxNTU6IHtcbiAgICAgICAgICAgICAgICBhY2NvdW50czogbmFtZXNwYWNlcy5jaGFpbnMsXG4gICAgICAgICAgICAgICAgbWV0aG9kczogbmFtZXNwYWNlcy5tZXRob2RzLFxuICAgICAgICAgICAgICAgIGV2ZW50czogbmFtZXNwYWNlcy5ldmVudHMsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhcHByb3ZhbC5hY2tub3dsZWRnZWQoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB0b3BpYzogc2Vzc2lvbi50b3BpYyxcbiAgICAgICAgb3JpZ2luOiBzZXNzaW9uUHJvcG9zYWwudmVyaWZ5Q29udGV4dD8udmVyaWZpZWQ/Lm9yaWdpbiB8fCBcIlVua25vd24gb3JpZ2luXCIsXG4gICAgfTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlc3Npb24tcHJvcG9zYWwuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/thirdweb/dist/esm/wallets/wallet-connect/receiver/session-proposal.js\n"));

/***/ })

}]);